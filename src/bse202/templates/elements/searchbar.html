<style>
    .search-bar {
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: column;
        color: white;
        font-family: Poppins;
    }
    #search-result-container{
        margin-top: 280px;
        position: absolute;
        border: 1px solid #ccc;
        display: none;
        max-height: 200px;
        overflow-y: auto;
        width: 200px;
       }
       #search-result-container ul {
        padding-top: 20px;
        list-style-type: none;
        padding: 0;
        margin: 0;
        font-size: 24px;
        padding-left: 10px;
       }
       #search-result-container li {
        padding: 8px;
        cursor: pointer;
        background-color: #9290C3;
       }
       #search-result-container li:hover {
        background-color: #5F3B51;
       }
</style>
<div class="search-bar">
    <input type="text" id="search-bar" placeholder="Search" style=" border-radius: 20px;width: 250px; height: 60px; text-align: center; font-size: 24px;">
    <div id="search-result-container">
        <ul id="search-result"></ul>
    </div>
</div>
{%include 'elements/product-detail.html'%}
{%include 'elements/game-launching.html'%}
<script>
    document.getElementById('search-bar').addEventListener('input', function() {
           const query = this.value;
           const resultsDiv = document.getElementById('search-result-container');
           const resultsList = document.getElementById('search-result');
           if (query) {
               fetch(`/search?query=${query}`)
                   .then(response => response.json())
                   .then(gamelist => {
                       resultsList.innerHTML = '';
                       gamelist.forEach(game => {
                           const li = document.createElement('li');
                           li.textContent = game.name;
                           li.addEventListener('click', () => {
                               showProductDetails(game.name,game.image,game.description,game.id);
                           }); //Action for each game
                           resultsList.appendChild(li);
                       });
                       resultsDiv.style.display = 'block';
                   });
           } else {
               resultsList.innerHTML = '';
               resultsDiv.style.display = 'none';
           }
       });
    function showProductDetails(name, image, description,id) {
            document.getElementById('modal-product-name').innerText = name;
            document.getElementById('modal-product-image').src = "{{ url_for('static', filename='') }}" + image;
            document.getElementById('modal-product-description').innerText = description;
            if (id==true)
            {
                document.getElementById('modal-product-play-button').style.display='block';
                document.getElementById('modal-product-cart-button').style.display='none';
                document.getElementById('play-button-display').onclick = function() {playinggame(name);};
            }
            else
            {
                document.getElementById('modal-product-cart-button').style.display='block';
                document.getElementById('modal-product-play-button').style.display='none';
            }
            document.getElementById('modal-product-name-input').value = name;
            document.getElementById('product-modal').style.display = 'block';
        }
        function playinggame(name)
        {
            document.getElementById('product-modal').style.display = 'none';
            document.getElementById('game-on-display').style.display='flex';
            document.getElementById('game-on-launching').innerText='Launching '+name+' ...';
            document.getElementById('game-on-launching').style.display='flex';
            setTimeout(function() {
            document.getElementById('game-on-launching').style.display = 'none';
            document.getElementById('game-on-starting').innerText='Starting '+name+'!';
            document.getElementById('game-on-starting').style.display = 'flex';
            }, 1500);
            setTimeout(function() {
            document.getElementById('game-on-starting').style.display = 'none';
            document.getElementById('game-on-display').style.display = 'none';
            }, 2000);
        }
        function closeModal() {
            document.getElementById('product-modal').style.display = 'none';
        }
</script>